!function(a){var b=function(a,b){this.defaults=function(){return{columns:12,rows:6,radius:300,perspective:800,translateX:0,translateY:0,translateZ:0,rotateX:0,rotateY:0,rotateZ:0,animation:"rotateY",poleCaps:[90,270]}},this.state=this.defaults(),this.merge=function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c]);return a};var c={};this.cache={get:function(a){return c.hasOwnProperty(a)?c[a]:null},set:function(a,b){c[a]=b},purge:function(a){a=a||!1,a?delete c[a]:c={}}},this.merge(this.state,b||{}),this.nodes={scene:document.createElement("div"),sphere:document.createElement("div"),container:document.createElement("div"),columns:[]},this.nodes.scene.className="scene",this.nodes.sphere.className="sphere",this.nodes.container.className="container",a.appendChild(this.nodes.scene),this.nodes.scene.appendChild(this.nodes.sphere),this.nodes.sphere.appendChild(this.nodes.container),this.draw()};b.prototype.updateState=function(a){if("[object Object]"!==Object.prototype.toString.call(a))return!1;var b,c,d=this.defaults();for(var e in a)a.hasOwnProperty(e)&&d.hasOwnProperty(e)&&(b=Object.prototype.toString.call(d[e]),c=Object.prototype.toString.call(a[e]),c===b&&"[object Number]"!==b||"[object Number]"===b&&(a[e]=parseInt(a[e],10),isNaN(a[e])&&delete a[e]));this.merge(this.state,a),this.draw()},b.prototype.draw=function(){this.nodes.columns=[],this.nodes.container.innerHTML="",this.nodes.scene.style.minWidth=2*this.state.radius+"px",this.nodes.scene.style.minHeight=2*this.state.radius+"px";var a,b,c={row:360/this.state.columns,column:180/this.state.rows},d={z:this.state.radius/2/Math.tan(c.column*Math.PI/180)};this.coordinates();for(var e=0;e<this.state.rows;e++){a=this.renderRow(e,c.row),this.nodes.container.appendChild(a);for(var f=0;f<this.state.columns;f++)b=this.renderColumn(e,f,c.column,d),b&&(a.appendChild(b),this.nodes.columns.push(b))}this.nodes.scene.style.perspective=this.state.perspective+"px",this.sphereClass(),this.sphereTransforms(),this.sphereAnimation()},b.prototype.renderRow=function(a,b){var c={x:a*b},d=document.createElement("div");return d.className="sphere-row row-"+a,d.style.transform="rotateX("+c.x+"deg)",d},b.prototype.renderColumn=function(a,b,c,d){var e={y:b*c};if(!this.isDisplayableColumn(a,e.y))return!1;var f=document.createElement("div");return f.className="sphere-column row-"+a+" col-"+b,f.style.transform="rotateY("+e.y+"deg) translateZ("+d.z+"px)",f},b.prototype.isDisplayableColumn=function(a,b){var c=this.state.poleCaps.indexOf(b)>-1;if(c&&0!==a)return!1;for(var d=!1,e=0;e<this.state.poleCaps.length&&!(d=Math.abs(this.state.poleCaps[e]-b)<=30);e++);return!(d&&a%2)},b.prototype.sphereTransforms=function(){var a=this.state,b=[],c=function(){for(var b=arguments[0],c=[],d=1;d<arguments.length;d++)c.push(arguments[d]+"("+a[arguments[d]]+b+")");return c};b=b.concat(c("px","translateX","translateY","translateZ")),b=b.concat(c("deg","rotateX","rotateY","rotateZ")),b.length&&(this.nodes.container.style.transform=b.join(" "))},b.prototype.sphereAnimation=function(){this.state.animation?this.nodes.sphere.style.animation=this.state.animation+" 25s infinite linear":this.nodes.sphere.style.animation=null},b.prototype.sphereClass=function(a){a=a||null;var b=this.cache.get("sphereClass");this.cache.purge("sphereClass"),b&&this.nodes.sphere.classList.remove(b),a&&(this.nodes.sphere.classList.add(a),this.cache.set("sphereClass",a))},b.prototype.reset=function(){this.state=this.defaults(),this.sphereClass(),this.draw()},b.prototype.columContent=function(a,b){b="number"==typeof b?b:-1;var c=this.nodes.columns;console.log(b,a);var d=function(a,b){if("undefined"==typeof c[a])return-1;for(;c[a].firstChild;)c[a].removeChild(c[a].firstChild);var d=document.createElement("div");return d.className="column-content","string"==typeof b?d.innerHTML=b:d.appendChild(b),c[a].appendChild(d),a};if(b>-1)return d(b,a);for(var e=0;e<c.length;e++)d(e,a);return c.length-1},b.prototype.line=function(a,b){b=b||"rgb(255, 255, 255)";var c=document.createElement("div");return c.className="sphere-line",c.style.position="absolute",c.style.width=a,c.style.left=0,c.style.top="50%",c.style.height="1px",c.style.borderBottomWidth="1px",c.style.borderBottomStyle="solid",c.style.borderBottomColor=b,c.style.backfaceVisibility="visible",c},b.prototype.coordinates=function(){var a=document.createElement("div");a.className="sphere-coordinates",a.style.position="absolute",a.style.width="100%",a.style.height="100%",this.nodes.container.appendChild(a);var b="100%",c=this.line(b,"red");a.appendChild(c);var d=this.line(b,"blue");d.style.transform="rotateY(90deg)",a.appendChild(d);var e=this.line(b,"green");return e.style.transform="rotateZ(90deg)",a.appendChild(e),a},a.Sphere=b}(window);